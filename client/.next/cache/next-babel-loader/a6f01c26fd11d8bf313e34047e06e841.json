{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Sarthak\\\\YT_Workflow_Cloud\\\\client\\\\pages\\\\workflow\\\\[id].js\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport { useSelector } from 'react-redux'; // import { jwt } from '../../components/JWT';\n\nimport Router from 'next/router';\nimport React, { useState, useEffect } from 'react';\nimport DashboardMenu from '../../components/DashboardMenu';\nimport styles from '../../styles/scss/worklow_editor.module.scss';\nimport Cookie from 'js-cookie';\nimport { parseCookie } from '../../components/parseCookie';\nimport WorkflowDescription from '../../components/WorkflowDescription'; // const dispatch = useDispatch();\n\nvar Workflow = function Workflow(props) {\n  _s();\n\n  // console.log(Router.pathname);\n  var jwtToken = useSelector(function (state) {\n    return state.jwtToken;\n  });\n\n  var _useState = useState([]),\n      audioUrls = _useState[0],\n      setAudioUrls = _useState[1];\n\n  var _useState2 = useState([]),\n      imageUrls = _useState2[0],\n      setImageUrls = _useState2[1];\n\n  var _useState3 = useState([]),\n      videoUrls = _useState3[0],\n      setVideoUrls = _useState3[1];\n\n  var _useState4 = useState([]),\n      videoEditingUrls = _useState4[0],\n      setVideoEditingUrls = _useState4[1];\n\n  var _useState5 = useState(null),\n      description = _useState5[0],\n      setDescription = _useState5[1];\n\n  var _useState6 = useState(null),\n      title = _useState6[0],\n      setTitle = _useState6[1];\n\n  var _useState7 = useState(null),\n      starred = _useState7[0],\n      setStarred = _useState7[1];\n\n  var _useState8 = useState(null),\n      finished = _useState8[0],\n      setFinished = _useState8[1];\n\n  var _useState9 = useState(false),\n      fetched = _useState9[0],\n      setFetched = _useState9[1]; // const id = Router.query.id;\n\n\n  var id = props.id;\n  useEffect(function () {\n    fetch(\"http://127.0.0.1:8000/get-workflow/\".concat(id), {\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: \"Bearer \".concat(jwtToken)\n      }\n    }).then(function (res) {\n      return res.json();\n    }).then(function (workflowInfoJson) {\n      workflowInfoJson = workflowInfoJson['workflow'];\n      setDescription(workflowInfoJson.description);\n      setTitle(workflowInfoJson.title);\n      setStarred(workflowInfoJson.starred);\n      setFinished(workflowInfoJson.finished);\n    })[\"catch\"](function (err) {\n      return console.log(err);\n    });\n    fetch(\"http://127.0.0.1:8000/get-workflow-files/\".concat(id), {\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: \"Bearer \".concat(jwtToken)\n      }\n    }).then(function (res) {\n      return res.json();\n    }).then(function (filesJson) {\n      var fileUrlsJson = filesJson['workflow-file-urls']; // console.log(filesJson['workflow-file-urls']);\n\n      setAudioUrls(fileUrlsJson['audio']);\n      setImageUrls(fileUrlsJson['images']);\n      setVideoUrls(fileUrlsJson['videos']);\n      setVideoEditingUrls(fileUrlsJson['video_editing']);\n    })[\"catch\"](function (err) {\n      return console.log(err);\n    });\n    setFetched(true);\n  }, []); // console.log('hi');\n\n  return __jsx(\"main\", {\n    className: styles.workflowEditorContainer,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 3\n    }\n  }, __jsx(\"div\", {\n    className: styles.dashboardMenuContainer,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 4\n    }\n  }, __jsx(DashboardMenu, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 5\n    }\n  })), __jsx(\"div\", {\n    className: styles.editor,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 4\n    }\n  }, !fetched ? __jsx(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 17\n    }\n  }, \"Fetching\") : __jsx(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 39\n    }\n  }, \"Fetched\"), __jsx(WorkflowDescription, {\n    initialDescription: description,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 5\n    }\n  }), __jsx(\"div\", {\n    className: styles.images,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 5\n    }\n  }, __jsx(\"h2\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 6\n    }\n  }, \"Images\"), imageUrls.map(function (imageUrl) {\n    var dotParts = imageUrl.split('.');\n    var mimeType = dotParts[dotParts.length - 1];\n    return __jsx(\"a\", {\n      href: imageUrl,\n      key: imageUrl,\n      download: \"hi.\".concat(mimeType),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 8\n      }\n    }, __jsx(\"img\", {\n      src: imageUrl,\n      className: styles.workflowImage,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 9\n      }\n    }));\n  })), __jsx(\"div\", {\n    className: styles.audios,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 5\n    }\n  }, __jsx(\"h2\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 6\n    }\n  }, \"Audio\"), audioUrls.map(function (audioUrl) {\n    var dotParts = audioUrl.split('.');\n    var mimeType = dotParts[dotParts.length - 1];\n    return __jsx(\"audio\", {\n      key: audioUrl,\n      controls: true,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 8\n      }\n    }, __jsx(\"source\", {\n      src: audioUrl,\n      type: \"audio/\".concat(mimeType),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 9\n      }\n    }), \";\");\n  })), __jsx(\"div\", {\n    className: styles.videos,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 5\n    }\n  }, __jsx(\"h2\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 6\n    }\n  }, \"Videos\"), videoUrls.map(function (videoUrl) {\n    var dotParts = videoUrl.split('.');\n    var mimeType = dotParts[dotParts.length - 1]; // console.log(`video/${mimeType}`);\n\n    if (mimeType !== 'mov') {\n      return __jsx(\"video\", {\n        key: videoUrl,\n        className: styles.workflowVideo,\n        width: \"320\",\n        height: \"240\",\n        controls: true,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 9\n        }\n      }, __jsx(\"source\", {\n        src: videoUrl,\n        type: \"video/\".concat(mimeType),\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 10\n        }\n      }), \";\");\n    } else {\n      return __jsx(React.Fragment, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 15\n        }\n      });\n    }\n  })), __jsx(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 5\n    }\n  }, videoEditingUrls)));\n};\n\n_s(Workflow, \"c97Tk2x8aS+tR0Wdw6S+OGapxlE=\", false, function () {\n  return [useSelector];\n});\n\n_c = Workflow;\nexport var __N_SSP = true;\nexport function getServerSidePaths(_x) {\n  return _getServerSidePaths.apply(this, arguments);\n}\n\nfunction _getServerSidePaths() {\n  _getServerSidePaths = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref) {\n    var req, cookies, res, resJson, workflowIds, paths;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            req = _ref.req;\n            cookies = parseCookie(req);\n            _context.next = 4;\n            return fetch('http://127.0.0.1:8000/get-workflow-ids', {\n              headers: {\n                'Content-Type': 'application/json',\n                Authorization: cookies.jwt\n              }\n            });\n\n          case 4:\n            res = _context.sent;\n            resJson = res.json();\n            workflowIds = resJson['workflow-ids'];\n            paths = workflowIds.map(function (workflowId) {\n              return {\n                params: {\n                  id: workflowId.toString()\n                }\n              };\n            });\n            return _context.abrupt(\"return\", {\n              paths: paths,\n              fallback: false\n            });\n\n          case 9:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _getServerSidePaths.apply(this, arguments);\n}\n\nexport default Workflow;\n\nvar _c;\n\n$RefreshReg$(_c, \"Workflow\");","map":{"version":3,"sources":["C:/Sarthak/YT_Workflow_Cloud/client/pages/workflow/[id].js"],"names":["useSelector","Router","React","useState","useEffect","DashboardMenu","styles","Cookie","parseCookie","WorkflowDescription","Workflow","props","jwtToken","state","audioUrls","setAudioUrls","imageUrls","setImageUrls","videoUrls","setVideoUrls","videoEditingUrls","setVideoEditingUrls","description","setDescription","title","setTitle","starred","setStarred","finished","setFinished","fetched","setFetched","id","fetch","headers","Authorization","then","res","json","workflowInfoJson","err","console","log","filesJson","fileUrlsJson","workflowEditorContainer","dashboardMenuContainer","editor","images","map","imageUrl","dotParts","split","mimeType","length","workflowImage","audios","audioUrl","videos","videoUrl","workflowVideo","getServerSidePaths","req","cookies","jwt","resJson","workflowIds","paths","workflowId","params","toString","fallback"],"mappings":"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","sourcesContent":["import { useSelector } from 'react-redux';\r\n// import { jwt } from '../../components/JWT';\r\nimport Router from 'next/router';\r\nimport React, { useState, useEffect } from 'react';\r\nimport DashboardMenu from '../../components/DashboardMenu';\r\nimport styles from '../../styles/scss/worklow_editor.module.scss';\r\nimport Cookie from 'js-cookie';\r\nimport { parseCookie } from '../../components/parseCookie';\r\nimport WorkflowDescription from '../../components/WorkflowDescription';\r\n\r\n// const dispatch = useDispatch();\r\n\r\nconst Workflow = (props) => {\r\n\t// console.log(Router.pathname);\r\n\tconst jwtToken = useSelector((state) => state.jwtToken);\r\n\r\n\tconst [ audioUrls, setAudioUrls ] = useState([]);\r\n\tconst [ imageUrls, setImageUrls ] = useState([]);\r\n\tconst [ videoUrls, setVideoUrls ] = useState([]);\r\n\tconst [ videoEditingUrls, setVideoEditingUrls ] = useState([]);\r\n\tconst [ description, setDescription ] = useState(null);\r\n\tconst [ title, setTitle ] = useState(null);\r\n\tconst [ starred, setStarred ] = useState(null);\r\n\tconst [ finished, setFinished ] = useState(null);\r\n\tconst [ fetched, setFetched ] = useState(false);\r\n\t// const id = Router.query.id;\r\n\tconst id = props.id;\r\n\r\n\tuseEffect(() => {\r\n\t\tfetch(`http://127.0.0.1:8000/get-workflow/${id}`, {\r\n\t\t\theaders: {\r\n\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t\tAuthorization: `Bearer ${jwtToken}`\r\n\t\t\t}\r\n\t\t})\r\n\t\t\t.then((res) => res.json())\r\n\t\t\t.then((workflowInfoJson) => {\r\n\t\t\t\tworkflowInfoJson = workflowInfoJson['workflow'];\r\n\t\t\t\tsetDescription(workflowInfoJson.description);\r\n\t\t\t\tsetTitle(workflowInfoJson.title);\r\n\t\t\t\tsetStarred(workflowInfoJson.starred);\r\n\t\t\t\tsetFinished(workflowInfoJson.finished);\r\n\t\t\t})\r\n\t\t\t.catch((err) => console.log(err));\r\n\r\n\t\tfetch(`http://127.0.0.1:8000/get-workflow-files/${id}`, {\r\n\t\t\theaders: {\r\n\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t\tAuthorization: `Bearer ${jwtToken}`\r\n\t\t\t}\r\n\t\t})\r\n\t\t\t.then((res) => res.json())\r\n\t\t\t.then((filesJson) => {\r\n\t\t\t\tconst fileUrlsJson = filesJson['workflow-file-urls'];\r\n\t\t\t\t// console.log(filesJson['workflow-file-urls']);\r\n\t\t\t\tsetAudioUrls(fileUrlsJson['audio']);\r\n\t\t\t\tsetImageUrls(fileUrlsJson['images']);\r\n\t\t\t\tsetVideoUrls(fileUrlsJson['videos']);\r\n\t\t\t\tsetVideoEditingUrls(fileUrlsJson['video_editing']);\r\n\t\t\t})\r\n\t\t\t.catch((err) => console.log(err));\r\n\t\tsetFetched(true);\r\n\t}, []);\r\n\r\n\t// console.log('hi');\r\n\treturn (\r\n\t\t<main className={styles.workflowEditorContainer}>\r\n\t\t\t<div className={styles.dashboardMenuContainer}>\r\n\t\t\t\t<DashboardMenu />\r\n\t\t\t</div>\r\n\t\t\t<div className={styles.editor}>\r\n\t\t\t\t{!fetched ? <div>Fetching</div> : <div>Fetched</div>}\r\n\r\n\t\t\t\t<WorkflowDescription initialDescription={description} />\r\n\t\t\t\t<div className={styles.images}>\r\n\t\t\t\t\t<h2>Images</h2>\r\n\t\t\t\t\t{imageUrls.map((imageUrl) => {\r\n\t\t\t\t\t\tconst dotParts = imageUrl.split('.');\r\n\t\t\t\t\t\tconst mimeType = dotParts[dotParts.length - 1];\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<a href={imageUrl} key={imageUrl} download={`hi.${mimeType}`}>\r\n\t\t\t\t\t\t\t\t<img src={imageUrl} className={styles.workflowImage} />\r\n\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t})}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className={styles.audios}>\r\n\t\t\t\t\t<h2>Audio</h2>\r\n\t\t\t\t\t{audioUrls.map((audioUrl) => {\r\n\t\t\t\t\t\tconst dotParts = audioUrl.split('.');\r\n\t\t\t\t\t\tconst mimeType = dotParts[dotParts.length - 1];\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<audio key={audioUrl} controls>\r\n\t\t\t\t\t\t\t\t<source src={audioUrl} type={`audio/${mimeType}`} />;\r\n\t\t\t\t\t\t\t</audio>\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t})}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className={styles.videos}>\r\n\t\t\t\t\t<h2>Videos</h2>\r\n\t\t\t\t\t{videoUrls.map((videoUrl) => {\r\n\t\t\t\t\t\tconst dotParts = videoUrl.split('.');\r\n\t\t\t\t\t\tconst mimeType = dotParts[dotParts.length - 1];\r\n\r\n\t\t\t\t\t\t// console.log(`video/${mimeType}`);\r\n\t\t\t\t\t\tif (mimeType !== 'mov') {\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t<video\r\n\t\t\t\t\t\t\t\t\tkey={videoUrl}\r\n\t\t\t\t\t\t\t\t\tclassName={styles.workflowVideo}\r\n\t\t\t\t\t\t\t\t\twidth=\"320\"\r\n\t\t\t\t\t\t\t\t\theight=\"240\"\r\n\t\t\t\t\t\t\t\t\tcontrols\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<source src={videoUrl} type={`video/${mimeType}`} />;\r\n\t\t\t\t\t\t\t\t</video>\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treturn <React.Fragment />;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div>{videoEditingUrls}</div>\r\n\t\t\t</div>\r\n\t\t</main>\r\n\t);\r\n};\r\n\r\nexport async function getServerSideProps({ params }) {\r\n\t// console.log(params.id);\r\n\treturn {\r\n\t\tprops: {\r\n\t\t\tid: params.id\r\n\t\t}\r\n\t};\r\n}\r\n\r\nexport async function getServerSidePaths({ req }) {\r\n\tconst cookies = parseCookie(req);\r\n\tconst res = await fetch('http://127.0.0.1:8000/get-workflow-ids', {\r\n\t\theaders: {\r\n\t\t\t'Content-Type': 'application/json',\r\n\t\t\tAuthorization: cookies.jwt\r\n\t\t}\r\n\t});\r\n\tconst resJson = res.json();\r\n\tconst workflowIds = resJson['workflow-ids'];\r\n\tconst paths = workflowIds.map((workflowId) => {\r\n\t\treturn {\r\n\t\t\tparams: {\r\n\t\t\t\tid: workflowId.toString()\r\n\t\t\t}\r\n\t\t};\r\n\t});\r\n\treturn {\r\n\t\tpaths,\r\n\t\tfallback: false\r\n\t};\r\n}\r\n\r\nexport default Workflow;\r\n"]},"metadata":{},"sourceType":"module"}