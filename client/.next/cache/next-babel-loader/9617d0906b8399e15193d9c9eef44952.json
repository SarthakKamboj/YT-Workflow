{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _this = this,\n    _jsxFileName = \"C:\\\\Sarthak\\\\YT_Workflow_Cloud\\\\client\\\\pages\\\\workflow\\\\[id].js\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport { useSelector } from 'react-redux'; // import { jwt } from '../../components/JWT';\n\nimport Router from 'next/router';\nimport React, { useState, useEffect } from 'react';\nimport DashboardMenu from '../../components/DashboardMenu';\nimport styles from '../../styles/scss/worklow_editor.module.scss';\nimport Cookie from 'js-cookie';\nimport classnames from 'classnames';\nimport { parseCookie } from '../../components/parseCookie';\nimport WorkflowDescription from '../../components/WorkflowDescription';\nimport AddFile from '../../components/addFile';\nimport Share from '../../components/Share';\nimport WorkflowTitle from '../../components/WorkflowTitle';\nimport WorkflowStarredAndFinished from '../../components/WorkflowStarredAndFinished';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport WorkflowDeleteBtn from '../../components/WorkflowDeleteBtn'; // const dispatch = useDispatch();\n\nvar Workflow = function Workflow(props) {\n  _s();\n\n  // console.log(Router.pathname);\n  var jwtToken = useSelector(function (state) {\n    return state.jwtToken;\n  });\n\n  var _useState = useState([]),\n      audioUrls = _useState[0],\n      setAudioUrls = _useState[1];\n\n  var _useState2 = useState([]),\n      imageUrls = _useState2[0],\n      setImageUrls = _useState2[1];\n\n  var _useState3 = useState([]),\n      thumbnailUrls = _useState3[0],\n      setThumbnailUrls = _useState3[1];\n\n  var _useState4 = useState([]),\n      videoUrls = _useState4[0],\n      setVideoUrls = _useState4[1];\n\n  var _useState5 = useState([]),\n      videoEditingUrls = _useState5[0],\n      setVideoEditingUrls = _useState5[1];\n\n  var _useState6 = useState(null),\n      description = _useState6[0],\n      setDescription = _useState6[1];\n\n  var _useState7 = useState(null),\n      title = _useState7[0],\n      setTitle = _useState7[1];\n\n  var _useState8 = useState(null),\n      starred = _useState8[0],\n      setStarred = _useState8[1];\n\n  var _useState9 = useState(null),\n      finished = _useState9[0],\n      setFinished = _useState9[1];\n\n  var _useState10 = useState(false),\n      fetched = _useState10[0],\n      setFetched = _useState10[1]; // const id = Router.query.id;\n\n\n  var id = props.id;\n\n  var _useState11 = useState(''),\n      creator = _useState11[0],\n      setCreator = _useState11[1];\n\n  var _useState12 = useState([]),\n      otherUsers = _useState12[0],\n      setOtherUsers = _useState12[1];\n\n  useEffect(function () {\n    function fetchData() {\n      return _fetchData.apply(this, arguments);\n    }\n\n    function _fetchData() {\n      _fetchData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var workflowInfoRes, workflowInfoJson, workflowInfo, workflowFilesRes, filesJson, fileUrlsJson;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return fetch(\"http://127.0.0.1:8000/get-workflow/\".concat(id), {\n                  headers: {\n                    'Content-Type': 'application/json',\n                    Authorization: \"Bearer \".concat(jwtToken)\n                  }\n                });\n\n              case 2:\n                workflowInfoRes = _context.sent;\n                _context.next = 5;\n                return workflowInfoRes.json();\n\n              case 5:\n                workflowInfoJson = _context.sent;\n                console.log(workflowInfoJson); // .then((workflowInfoJson) => {\n\n                workflowInfo = workflowInfoJson['workflow'];\n                setDescription(workflowInfo.description);\n                setTitle(workflowInfo.title);\n                setStarred(workflowInfo.starred);\n                setFinished(workflowInfo.finished);\n                setOtherUsers(workflowInfo['other_users']);\n                setCreator(workflowInfoJson.creator);\n                _context.next = 16;\n                return fetch(\"http://127.0.0.1:8000/get-workflow-files/\".concat(id), {\n                  headers: {\n                    'Content-Type': 'application/json',\n                    Authorization: \"Bearer \".concat(jwtToken)\n                  }\n                });\n\n              case 16:\n                workflowFilesRes = _context.sent;\n                _context.next = 19;\n                return workflowFilesRes.json();\n\n              case 19:\n                filesJson = _context.sent;\n                fileUrlsJson = filesJson['workflow-file-urls'];\n                setAudioUrls(fileUrlsJson['audio']);\n                setImageUrls(fileUrlsJson['image']);\n                setVideoUrls(fileUrlsJson['video']);\n                setThumbnailUrls(fileUrlsJson['thumbnail']);\n                setVideoEditingUrls(fileUrlsJson['video_editing']);\n                setFetched(true);\n                console.log(fileUrlsJson);\n\n              case 28:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n      return _fetchData.apply(this, arguments);\n    }\n\n    fetchData();\n  }, []);\n\n  var updateFileCollections = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(fileType) {\n      var res, resJson, urls;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return fetch(\"http://localhost:8000/get-workflow-files/\".concat(id, \"/\").concat(fileType), {\n                headers: {\n                  'Content-Type': 'application/json',\n                  Authorization: 'Bearer ' + jwtToken\n                }\n              });\n\n            case 2:\n              res = _context2.sent;\n              _context2.next = 5;\n              return res.json();\n\n            case 5:\n              resJson = _context2.sent;\n              console.log(resJson);\n              urls = resJson['workflow-specific-urls'];\n              _context2.t0 = fileType;\n              _context2.next = _context2.t0 === 'image' ? 11 : _context2.t0 === 'video' ? 13 : _context2.t0 === 'thumbnail' ? 15 : _context2.t0 === 'audio' ? 17 : 19;\n              break;\n\n            case 11:\n              setImageUrls(urls);\n              return _context2.abrupt(\"break\", 19);\n\n            case 13:\n              setVideoUrls(urls);\n              return _context2.abrupt(\"break\", 19);\n\n            case 15:\n              setThumbnailUrls(urls);\n              return _context2.abrupt(\"break\", 19);\n\n            case 17:\n              setAudioUrls(urls);\n              return _context2.abrupt(\"break\", 19);\n\n            case 19:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function updateFileCollections(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var deleteFile = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(url, fileType) {\n      var fileParts, fileName;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              if (!confirm('Are you sure you want to delete this file?')) {\n                _context3.next = 7;\n                break;\n              }\n\n              fileParts = url.split('/');\n              fileName = fileParts[fileParts.length - 1];\n              _context3.next = 5;\n              return fetch(\"http://localhost:8000/delete-file/\".concat(id, \"/\").concat(fileType), {\n                method: 'DELETE',\n                headers: {\n                  'Content-Type': 'application/json',\n                  Authorization: 'Bearer ' + jwtToken\n                },\n                body: JSON.stringify({\n                  file_name: fileName\n                })\n              });\n\n            case 5:\n              _context3.next = 7;\n              return updateFileCollections(fileType);\n\n            case 7:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function deleteFile(_x2, _x3) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var pageInfo = function pageInfo() {\n    if (!fetched) {\n      return __jsx(\"div\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 11\n        }\n      }, \"Fetching\");\n    } else {\n      return __jsx(React.Fragment, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 5\n        }\n      }, __jsx(\"section\", {\n        className: styles.header,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 6\n        }\n      }, __jsx(\"div\", {\n        className: styles.workflowHeaderInfo,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 7\n        }\n      }, __jsx(WorkflowTitle, {\n        oldTitle: title,\n        id: id,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 8\n        }\n      }), __jsx(WorkflowStarredAndFinished, {\n        oldStarred: starred,\n        oldFinished: finished,\n        id: id,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 8\n        }\n      })), __jsx(Share, {\n        id: id,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 7\n        }\n      })), __jsx(\"section\", {\n        className: styles.content,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 6\n        }\n      }, __jsx(\"div\", {\n        className: styles.images,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 7\n        }\n      }, __jsx(\"h2\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 8\n        }\n      }, \"Thumbnails\"), __jsx(\"div\", {\n        className: styles.container,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 8\n        }\n      }, thumbnailUrls.map(function (thumbnailUrl) {\n        var dotParts = thumbnailUrl.split('.');\n        var mimeType = dotParts[dotParts.length - 1];\n        return __jsx(\"div\", {\n          className: styles.fileContainer,\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 141,\n            columnNumber: 11\n          }\n        }, __jsx(\"img\", {\n          src: thumbnailUrl,\n          className: styles.workflowImage,\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 12\n          }\n        }), __jsx(FontAwesomeIcon, {\n          icon: \"trash\",\n          className: styles.deleteIcon,\n          onClick: function onClick() {\n            return deleteFile(thumbnailUrl, 'thumbnail');\n          },\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 143,\n            columnNumber: 12\n          }\n        }));\n      }), __jsx(AddFile, {\n        fileType: 'thumbnail',\n        id: id,\n        updateFileCollections: updateFileCollections,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 9\n        }\n      }))), __jsx(\"div\", {\n        className: styles.images,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 7\n        }\n      }, __jsx(\"h2\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 8\n        }\n      }, \"Images\"), __jsx(\"div\", {\n        className: styles.container,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 8\n        }\n      }, imageUrls.map(function (imageUrl) {\n        var dotParts = imageUrl.split('.');\n        var mimeType = dotParts[dotParts.length - 1];\n        return __jsx(\"div\", {\n          className: styles.fileContainer,\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 162,\n            columnNumber: 11\n          }\n        }, __jsx(\"img\", {\n          src: imageUrl,\n          className: styles.workflowImage,\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 163,\n            columnNumber: 12\n          }\n        }), __jsx(FontAwesomeIcon, {\n          icon: \"trash\",\n          className: styles.deleteIcon,\n          onClick: function onClick() {\n            return deleteFile(imageUrl, 'image');\n          },\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 164,\n            columnNumber: 12\n          }\n        }));\n      }), __jsx(AddFile, {\n        fileType: 'image',\n        id: id,\n        updateFileCollections: updateFileCollections,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 9\n        }\n      }))), __jsx(\"div\", {\n        className: styles.audios,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 7\n        }\n      }, __jsx(\"h2\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 8\n        }\n      }, \"Audio\"), __jsx(\"div\", {\n        className: styles.container,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 8\n        }\n      }, audioUrls.map(function (audioUrl) {\n        var _classnames;\n\n        var dotParts = audioUrl.split('.');\n        var mimeType = dotParts[dotParts.length - 1];\n        return __jsx(\"div\", {\n          className: classnames((_classnames = {}, _defineProperty(_classnames, styles.fileContainer, true), _defineProperty(_classnames, styles.audioFileContainer, true), _classnames)),\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 182,\n            columnNumber: 11\n          }\n        }, __jsx(\"audio\", {\n          key: audioUrl,\n          controls: true,\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 12\n          }\n        }, __jsx(\"source\", {\n          src: audioUrl,\n          type: \"audio/\".concat(mimeType),\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 189,\n            columnNumber: 13\n          }\n        }), \";\"), __jsx(FontAwesomeIcon, {\n          icon: \"trash\",\n          className: styles.deleteIcon,\n          onClick: function onClick() {\n            return deleteFile(audioUrl, 'audio');\n          },\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 191,\n            columnNumber: 12\n          }\n        }));\n      }), __jsx(AddFile, {\n        fileType: 'audio',\n        id: id,\n        updateFileCollections: updateFileCollections,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199,\n          columnNumber: 9\n        }\n      }))), __jsx(\"div\", {\n        className: styles.videos,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 7\n        }\n      }, __jsx(\"h2\", {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 8\n        }\n      }, \"Videos\"), __jsx(\"div\", {\n        className: styles.container,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 8\n        }\n      }, videoUrls.map(function (videoUrl) {\n        var dotParts = videoUrl.split('.');\n        var mimeType = dotParts[dotParts.length - 1];\n\n        if (mimeType !== 'mov') {\n          return __jsx(\"div\", {\n            className: styles.fileContainer,\n            __self: _this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 210,\n              columnNumber: 12\n            }\n          }, __jsx(\"video\", {\n            key: videoUrl,\n            className: styles.workflowVideo,\n            width: \"320\",\n            height: \"240\",\n            controls: true,\n            __self: _this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 211,\n              columnNumber: 13\n            }\n          }, __jsx(\"source\", {\n            src: videoUrl,\n            type: \"video/\".concat(mimeType),\n            __self: _this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 218,\n              columnNumber: 14\n            }\n          })), __jsx(FontAwesomeIcon, {\n            icon: \"trash\",\n            className: styles.deleteIcon,\n            onClick: function onClick() {\n              return deleteFile(videoUrl, 'video');\n            },\n            __self: _this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 220,\n              columnNumber: 13\n            }\n          }));\n        } else {\n          return __jsx(React.Fragment, {\n            __self: _this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 228,\n              columnNumber: 18\n            }\n          });\n        }\n      }), __jsx(AddFile, {\n        fileType: 'video',\n        id: id,\n        updateFileCollections: updateFileCollections,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 9\n        }\n      }))), __jsx(WorkflowDescription, {\n        oldDescription: description,\n        id: id,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 7\n        }\n      }), __jsx(WorkflowDeleteBtn, {\n        id: id,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 7\n        }\n      })));\n    }\n  }; // console.log('hi');\n\n\n  return __jsx(\"main\", {\n    className: styles.workflowEditorContainer,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 3\n    }\n  }, __jsx(\"div\", {\n    className: styles.dashboardMenuContainer,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 4\n    }\n  }, __jsx(DashboardMenu, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 5\n    }\n  })), __jsx(\"div\", {\n    className: styles.editor,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 4\n    }\n  }, pageInfo()));\n};\n\n_s(Workflow, \"wOm5Xa0NrzIZNO8Ah9k+PB9OeAk=\", false, function () {\n  return [useSelector];\n});\n\n_c = Workflow;\nexport var __N_SSP = true;\nexport function getServerSidePaths(_x4) {\n  return _getServerSidePaths.apply(this, arguments);\n}\n\nfunction _getServerSidePaths() {\n  _getServerSidePaths = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(_ref3) {\n    var req, cookies, origWorkflowsRes, origWorkflowsJson, workflowIds, paths;\n    return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            req = _ref3.req;\n            cookies = parseCookie(req);\n            _context4.next = 4;\n            return fetch('http://127.0.0.1:8000/get-workflow-ids', {\n              headers: {\n                'Content-Type': 'application/json',\n                Authorization: cookies.jwt\n              }\n            });\n\n          case 4:\n            origWorkflowsRes = _context4.sent;\n            origWorkflowsJson = origWorkflowsRes.json();\n            workflowIds = origWorkflowsJson['workflow-ids']; // const shareRes = await fetch('http://localhost:8000/get-shared-workflow-ids', {\n            // \theaders: {\n            // \t\t'Content-Type': 'application/json',\n            // \t\tAuthorization: cookies.jwt\n            // \t}\n            // });\n            // const shareResJson = shareRes.json();\n            // const sharedWorkflowIds = shareResJson['workflow-ids'];\n            // console.log(sharedWorkflowIds);\n            // const workflowIds = origWorkflowsIds.concat(sharedWorkflowIds);\n\n            paths = workflowIds.map(function (workflowId) {\n              return {\n                params: {\n                  id: workflowId.toString()\n                }\n              };\n            });\n            return _context4.abrupt(\"return\", {\n              paths: paths,\n              fallback: false\n            });\n\n          case 9:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4);\n  }));\n  return _getServerSidePaths.apply(this, arguments);\n}\n\nexport default Workflow;\n\nvar _c;\n\n$RefreshReg$(_c, \"Workflow\");","map":{"version":3,"sources":["C:/Sarthak/YT_Workflow_Cloud/client/pages/workflow/[id].js"],"names":["useSelector","Router","React","useState","useEffect","DashboardMenu","styles","Cookie","classnames","parseCookie","WorkflowDescription","AddFile","Share","WorkflowTitle","WorkflowStarredAndFinished","FontAwesomeIcon","WorkflowDeleteBtn","Workflow","props","jwtToken","state","audioUrls","setAudioUrls","imageUrls","setImageUrls","thumbnailUrls","setThumbnailUrls","videoUrls","setVideoUrls","videoEditingUrls","setVideoEditingUrls","description","setDescription","title","setTitle","starred","setStarred","finished","setFinished","fetched","setFetched","id","creator","setCreator","otherUsers","setOtherUsers","fetchData","fetch","headers","Authorization","workflowInfoRes","json","workflowInfoJson","console","log","workflowInfo","workflowFilesRes","filesJson","fileUrlsJson","updateFileCollections","fileType","res","resJson","urls","deleteFile","url","confirm","fileParts","split","fileName","length","method","body","JSON","stringify","file_name","pageInfo","header","workflowHeaderInfo","content","images","container","map","thumbnailUrl","dotParts","mimeType","fileContainer","workflowImage","deleteIcon","imageUrl","audios","audioUrl","audioFileContainer","videos","videoUrl","workflowVideo","workflowEditorContainer","dashboardMenuContainer","editor","getServerSidePaths","req","cookies","jwt","origWorkflowsRes","origWorkflowsJson","workflowIds","paths","workflowId","params","toString","fallback"],"mappings":"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","sourcesContent":["import { useSelector } from 'react-redux';\r\n// import { jwt } from '../../components/JWT';\r\nimport Router from 'next/router';\r\nimport React, { useState, useEffect } from 'react';\r\nimport DashboardMenu from '../../components/DashboardMenu';\r\nimport styles from '../../styles/scss/worklow_editor.module.scss';\r\nimport Cookie from 'js-cookie';\r\nimport classnames from 'classnames';\r\nimport { parseCookie } from '../../components/parseCookie';\r\nimport WorkflowDescription from '../../components/WorkflowDescription';\r\nimport AddFile from '../../components/addFile';\r\nimport Share from '../../components/Share';\r\nimport WorkflowTitle from '../../components/WorkflowTitle';\r\nimport WorkflowStarredAndFinished from '../../components/WorkflowStarredAndFinished';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\nimport WorkflowDeleteBtn from '../../components/WorkflowDeleteBtn';\r\n\r\n// const dispatch = useDispatch();\r\n\r\nconst Workflow = (props) => {\r\n\t// console.log(Router.pathname);\r\n\tconst jwtToken = useSelector((state) => state.jwtToken);\r\n\r\n\tconst [ audioUrls, setAudioUrls ] = useState([]);\r\n\tconst [ imageUrls, setImageUrls ] = useState([]);\r\n\tconst [ thumbnailUrls, setThumbnailUrls ] = useState([]);\r\n\tconst [ videoUrls, setVideoUrls ] = useState([]);\r\n\tconst [ videoEditingUrls, setVideoEditingUrls ] = useState([]);\r\n\tconst [ description, setDescription ] = useState(null);\r\n\tconst [ title, setTitle ] = useState(null);\r\n\tconst [ starred, setStarred ] = useState(null);\r\n\tconst [ finished, setFinished ] = useState(null);\r\n\tconst [ fetched, setFetched ] = useState(false);\r\n\t// const id = Router.query.id;\r\n\tconst id = props.id;\r\n\tconst [ creator, setCreator ] = useState('');\r\n\tconst [ otherUsers, setOtherUsers ] = useState([]);\r\n\r\n\tuseEffect(() => {\r\n\t\tasync function fetchData() {\r\n\t\t\tconst workflowInfoRes = await fetch(`http://127.0.0.1:8000/get-workflow/${id}`, {\r\n\t\t\t\theaders: {\r\n\t\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t\t\tAuthorization: `Bearer ${jwtToken}`\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tconst workflowInfoJson = await workflowInfoRes.json();\r\n\t\t\tconsole.log(workflowInfoJson);\r\n\t\t\t// .then((workflowInfoJson) => {\r\n\t\t\tconst workflowInfo = workflowInfoJson['workflow'];\r\n\t\t\tsetDescription(workflowInfo.description);\r\n\t\t\tsetTitle(workflowInfo.title);\r\n\t\t\tsetStarred(workflowInfo.starred);\r\n\t\t\tsetFinished(workflowInfo.finished);\r\n\t\t\tsetOtherUsers(workflowInfo['other_users']);\r\n\t\t\tsetCreator(workflowInfoJson.creator);\r\n\t\t\tconst workflowFilesRes = await fetch(`http://127.0.0.1:8000/get-workflow-files/${id}`, {\r\n\t\t\t\theaders: {\r\n\t\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t\t\tAuthorization: `Bearer ${jwtToken}`\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tconst filesJson = await workflowFilesRes.json();\r\n\t\t\tconst fileUrlsJson = filesJson['workflow-file-urls'];\r\n\t\t\tsetAudioUrls(fileUrlsJson['audio']);\r\n\t\t\tsetImageUrls(fileUrlsJson['image']);\r\n\t\t\tsetVideoUrls(fileUrlsJson['video']);\r\n\t\t\tsetThumbnailUrls(fileUrlsJson['thumbnail']);\r\n\t\t\tsetVideoEditingUrls(fileUrlsJson['video_editing']);\r\n\t\t\tsetFetched(true);\r\n\t\t\tconsole.log(fileUrlsJson);\r\n\t\t}\r\n\t\tfetchData();\r\n\t}, []);\r\n\r\n\tconst updateFileCollections = async (fileType) => {\r\n\t\tconst res = await fetch(`http://localhost:8000/get-workflow-files/${id}/${fileType}`, {\r\n\t\t\theaders: {\r\n\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t\tAuthorization: 'Bearer ' + jwtToken\r\n\t\t\t}\r\n\t\t});\r\n\t\tconst resJson = await res.json();\r\n\t\tconsole.log(resJson);\r\n\t\tconst urls = resJson['workflow-specific-urls'];\r\n\t\tswitch (fileType) {\r\n\t\t\tcase 'image':\r\n\t\t\t\tsetImageUrls(urls);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'video':\r\n\t\t\t\tsetVideoUrls(urls);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'thumbnail':\r\n\t\t\t\tsetThumbnailUrls(urls);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'audio':\r\n\t\t\t\tsetAudioUrls(urls);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t};\r\n\r\n\tconst deleteFile = async (url, fileType) => {\r\n\t\tif (confirm('Are you sure you want to delete this file?')) {\r\n\t\t\tconst fileParts = url.split('/');\r\n\t\t\tconst fileName = fileParts[fileParts.length - 1];\r\n\t\t\tawait fetch(`http://localhost:8000/delete-file/${id}/${fileType}`, {\r\n\t\t\t\tmethod: 'DELETE',\r\n\t\t\t\theaders: {\r\n\t\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t\t\tAuthorization: 'Bearer ' + jwtToken\r\n\t\t\t\t},\r\n\t\t\t\tbody: JSON.stringify({\r\n\t\t\t\t\tfile_name: fileName\r\n\t\t\t\t})\r\n\t\t\t});\r\n\t\t\tawait updateFileCollections(fileType);\r\n\t\t}\r\n\t};\r\n\r\n\tconst pageInfo = () => {\r\n\t\tif (!fetched) {\r\n\t\t\treturn <div>Fetching</div>;\r\n\t\t} else {\r\n\t\t\treturn (\r\n\t\t\t\t<React.Fragment>\r\n\t\t\t\t\t<section className={styles.header}>\r\n\t\t\t\t\t\t<div className={styles.workflowHeaderInfo}>\r\n\t\t\t\t\t\t\t<WorkflowTitle oldTitle={title} id={id} />\r\n\t\t\t\t\t\t\t<WorkflowStarredAndFinished oldStarred={starred} oldFinished={finished} id={id} />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<Share id={id} />\r\n\t\t\t\t\t</section>\r\n\t\t\t\t\t<section className={styles.content}>\r\n\t\t\t\t\t\t<div className={styles.images}>\r\n\t\t\t\t\t\t\t<h2>Thumbnails</h2>\r\n\t\t\t\t\t\t\t<div className={styles.container}>\r\n\t\t\t\t\t\t\t\t{thumbnailUrls.map((thumbnailUrl) => {\r\n\t\t\t\t\t\t\t\t\tconst dotParts = thumbnailUrl.split('.');\r\n\t\t\t\t\t\t\t\t\tconst mimeType = dotParts[dotParts.length - 1];\r\n\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t<div className={styles.fileContainer}>\r\n\t\t\t\t\t\t\t\t\t\t\t<img src={thumbnailUrl} className={styles.workflowImage} />\r\n\t\t\t\t\t\t\t\t\t\t\t<FontAwesomeIcon\r\n\t\t\t\t\t\t\t\t\t\t\t\ticon=\"trash\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName={styles.deleteIcon}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => deleteFile(thumbnailUrl, 'thumbnail')}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t<AddFile fileType={'thumbnail'} id={id} updateFileCollections={updateFileCollections} />\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div className={styles.images}>\r\n\t\t\t\t\t\t\t<h2>Images</h2>\r\n\t\t\t\t\t\t\t<div className={styles.container}>\r\n\t\t\t\t\t\t\t\t{imageUrls.map((imageUrl) => {\r\n\t\t\t\t\t\t\t\t\tconst dotParts = imageUrl.split('.');\r\n\t\t\t\t\t\t\t\t\tconst mimeType = dotParts[dotParts.length - 1];\r\n\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t<div className={styles.fileContainer}>\r\n\t\t\t\t\t\t\t\t\t\t\t<img src={imageUrl} className={styles.workflowImage} />\r\n\t\t\t\t\t\t\t\t\t\t\t<FontAwesomeIcon\r\n\t\t\t\t\t\t\t\t\t\t\t\ticon=\"trash\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName={styles.deleteIcon}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => deleteFile(imageUrl, 'image')}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t<AddFile fileType={'image'} id={id} updateFileCollections={updateFileCollections} />\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className={styles.audios}>\r\n\t\t\t\t\t\t\t<h2>Audio</h2>\r\n\t\t\t\t\t\t\t<div className={styles.container}>\r\n\t\t\t\t\t\t\t\t{audioUrls.map((audioUrl) => {\r\n\t\t\t\t\t\t\t\t\tconst dotParts = audioUrl.split('.');\r\n\t\t\t\t\t\t\t\t\tconst mimeType = dotParts[dotParts.length - 1];\r\n\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\tclassName={classnames({\r\n\t\t\t\t\t\t\t\t\t\t\t\t[styles.fileContainer]: true,\r\n\t\t\t\t\t\t\t\t\t\t\t\t[styles.audioFileContainer]: true\r\n\t\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<audio key={audioUrl} controls>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<source src={audioUrl} type={`audio/${mimeType}`} />;\r\n\t\t\t\t\t\t\t\t\t\t\t</audio>\r\n\t\t\t\t\t\t\t\t\t\t\t<FontAwesomeIcon\r\n\t\t\t\t\t\t\t\t\t\t\t\ticon=\"trash\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName={styles.deleteIcon}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => deleteFile(audioUrl, 'audio')}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t<AddFile fileType={'audio'} id={id} updateFileCollections={updateFileCollections} />\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className={styles.videos}>\r\n\t\t\t\t\t\t\t<h2>Videos</h2>\r\n\t\t\t\t\t\t\t<div className={styles.container}>\r\n\t\t\t\t\t\t\t\t{videoUrls.map((videoUrl) => {\r\n\t\t\t\t\t\t\t\t\tconst dotParts = videoUrl.split('.');\r\n\t\t\t\t\t\t\t\t\tconst mimeType = dotParts[dotParts.length - 1];\r\n\t\t\t\t\t\t\t\t\tif (mimeType !== 'mov') {\r\n\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t<div className={styles.fileContainer}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<video\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tkey={videoUrl}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={styles.workflowVideo}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\twidth=\"320\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\theight=\"240\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcontrols\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<source src={videoUrl} type={`video/${mimeType}`} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t</video>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<FontAwesomeIcon\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ticon=\"trash\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={styles.deleteIcon}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => deleteFile(videoUrl, 'video')}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\treturn <React.Fragment />;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t<AddFile fileType={'video'} id={id} updateFileCollections={updateFileCollections} />\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{/* <div>{videoEditingUrls}</div> */}\r\n\t\t\t\t\t\t<WorkflowDescription oldDescription={description} id={id} />\r\n\t\t\t\t\t\t<WorkflowDeleteBtn id={id} />\r\n\t\t\t\t\t</section>\r\n\t\t\t\t</React.Fragment>\r\n\t\t\t);\r\n\t\t}\r\n\t};\r\n\r\n\t// console.log('hi');\r\n\treturn (\r\n\t\t<main className={styles.workflowEditorContainer}>\r\n\t\t\t<div className={styles.dashboardMenuContainer}>\r\n\t\t\t\t<DashboardMenu />\r\n\t\t\t</div>\r\n\t\t\t<div className={styles.editor}>{pageInfo()}</div>\r\n\t\t</main>\r\n\t);\r\n};\r\n\r\nexport async function getServerSideProps({ params }) {\r\n\t// console.log(params.id);\r\n\treturn {\r\n\t\tprops: {\r\n\t\t\tid: params.id\r\n\t\t}\r\n\t};\r\n}\r\n\r\nexport async function getServerSidePaths({ req }) {\r\n\tconst cookies = parseCookie(req);\r\n\tconst origWorkflowsRes = await fetch('http://127.0.0.1:8000/get-workflow-ids', {\r\n\t\theaders: {\r\n\t\t\t'Content-Type': 'application/json',\r\n\t\t\tAuthorization: cookies.jwt\r\n\t\t}\r\n\t});\r\n\tconst origWorkflowsJson = origWorkflowsRes.json();\r\n\tconst workflowIds = origWorkflowsJson['workflow-ids'];\r\n\r\n\t// const shareRes = await fetch('http://localhost:8000/get-shared-workflow-ids', {\r\n\t// \theaders: {\r\n\t// \t\t'Content-Type': 'application/json',\r\n\t// \t\tAuthorization: cookies.jwt\r\n\t// \t}\r\n\t// });\r\n\t// const shareResJson = shareRes.json();\r\n\t// const sharedWorkflowIds = shareResJson['workflow-ids'];\r\n\t// console.log(sharedWorkflowIds);\r\n\r\n\t// const workflowIds = origWorkflowsIds.concat(sharedWorkflowIds);\r\n\r\n\tconst paths = workflowIds.map((workflowId) => {\r\n\t\treturn {\r\n\t\t\tparams: {\r\n\t\t\t\tid: workflowId.toString()\r\n\t\t\t}\r\n\t\t};\r\n\t});\r\n\treturn {\r\n\t\tpaths,\r\n\t\tfallback: false\r\n\t};\r\n}\r\n\r\nexport default Workflow;\r\n"]},"metadata":{},"sourceType":"module"}