{"ast":null,"code":"var _jsxFileName = \"C:\\\\Sarthak\\\\YT_Workflow_Cloud\\\\client\\\\pages\\\\workflow\\\\[id].js\";\nvar __jsx = React.createElement;\nimport { useSelector } from 'react-redux'; // import { jwt } from '../../components/JWT';\n\nimport Router from 'next/router';\nimport React, { useState, useEffect } from 'react';\nimport DashboardMenu from '../../components/DashboardMenu';\nimport styles from '../../styles/scss/worklow_editor.module.scss';\nimport Cookie from 'js-cookie';\nimport { parseCookie } from '../../components/parseCookie';\nimport WorkflowDescription from '../../components/WorkflowDescription';\nimport AddFile from '../../components/addFile'; // const dispatch = useDispatch();\n\nconst Workflow = props => {\n  // console.log(Router.pathname);\n  const jwtToken = useSelector(state => state.jwtToken);\n  const {\n    0: audioUrls,\n    1: setAudioUrls\n  } = useState([]);\n  const {\n    0: imageUrls,\n    1: setImageUrls\n  } = useState([]);\n  const {\n    0: videoUrls,\n    1: setVideoUrls\n  } = useState([]);\n  const {\n    0: videoEditingUrls,\n    1: setVideoEditingUrls\n  } = useState([]);\n  const {\n    0: description,\n    1: setDescription\n  } = useState(null);\n  const {\n    0: title,\n    1: setTitle\n  } = useState(null);\n  const {\n    0: starred,\n    1: setStarred\n  } = useState(null);\n  const {\n    0: finished,\n    1: setFinished\n  } = useState(null);\n  const {\n    0: fetched,\n    1: setFetched\n  } = useState(false); // const id = Router.query.id;\n\n  const id = props.id;\n  useEffect(() => {\n    async function fetchData() {\n      const workflowInfoRes = await fetch(`http://127.0.0.1:8000/get-workflow/${id}`, {\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${jwtToken}`\n        }\n      });\n      const workflowInfoJson = await workflowInfoRes.json(); // .then((workflowInfoJson) => {\n\n      const workflowInfo = workflowInfoJson['workflow'];\n      setDescription(workflowInfo.description);\n      setTitle(workflowInfo.title);\n      setStarred(workflowInfo.starred);\n      setFinished(workflowInfo.finished); // })\n      // .catch((err) => console.log(err));\n\n      const workflowFilesRes = await fetch(`http://127.0.0.1:8000/get-workflow-files/${id}`, {\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${jwtToken}`\n        }\n      }); // .then((res) => res.json())\n\n      const filesJson = await workflowFilesRes.json(); // .then((filesJson) => {\n\n      const fileUrlsJson = filesJson['workflow-file-urls']; // console.log(filesJson['workflow-file-urls']);\n\n      setAudioUrls(fileUrlsJson['audio']);\n      setImageUrls(fileUrlsJson['images']);\n      setVideoUrls(fileUrlsJson['videos']);\n      setVideoEditingUrls(fileUrlsJson['video_editing']); // })\n      // .catch((err) => console.log(err));\n\n      setFetched(true);\n    }\n\n    fetchData();\n  }, []);\n\n  const pageInfo = () => {\n    if (!fetched) {\n      return __jsx(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 11\n        }\n      }, \"Fetching\");\n    } else {\n      return __jsx(React.Fragment, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 5\n        }\n      }, __jsx(WorkflowDescription, {\n        oldDescription: description,\n        id: id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 6\n        }\n      }), __jsx(\"div\", {\n        className: styles.images,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 6\n        }\n      }, __jsx(\"h2\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 7\n        }\n      }, \"Images\"), __jsx(\"div\", {\n        className: styles.container,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 7\n        }\n      }, imageUrls.map(imageUrl => {\n        const dotParts = imageUrl.split('.');\n        const mimeType = dotParts[dotParts.length - 1];\n        return __jsx(\"a\", {\n          href: imageUrl,\n          key: imageUrl,\n          download: `hi.${mimeType}`,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 10\n          }\n        }, __jsx(\"img\", {\n          src: imageUrl,\n          className: styles.workflowImage,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 86,\n            columnNumber: 11\n          }\n        }));\n      }), __jsx(AddFile, {\n        fileType: 'image',\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 8\n        }\n      }))), __jsx(\"div\", {\n        className: styles.audios,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 6\n        }\n      }, __jsx(\"h2\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 7\n        }\n      }, \"Audio\"), audioUrls.map(audioUrl => {\n        const dotParts = audioUrl.split('.');\n        const mimeType = dotParts[dotParts.length - 1];\n        return __jsx(\"audio\", {\n          key: audioUrl,\n          controls: true,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 9\n          }\n        }, __jsx(\"source\", {\n          src: audioUrl,\n          type: `audio/${mimeType}`,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 10\n          }\n        }), \";\");\n      })), __jsx(\"div\", {\n        className: styles.videos,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 6\n        }\n      }, __jsx(\"h2\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 7\n        }\n      }, \"Videos\"), videoUrls.map(videoUrl => {\n        const dotParts = videoUrl.split('.');\n        const mimeType = dotParts[dotParts.length - 1];\n\n        if (mimeType !== 'mov') {\n          return __jsx(\"video\", {\n            key: videoUrl,\n            className: styles.workflowVideo,\n            width: \"320\",\n            height: \"240\",\n            controls: true,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 112,\n              columnNumber: 10\n            }\n          }, __jsx(\"source\", {\n            src: videoUrl,\n            type: `video/${mimeType}`,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 119,\n              columnNumber: 11\n            }\n          }), \";\");\n        } else {\n          return __jsx(React.Fragment, {\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 123,\n              columnNumber: 16\n            }\n          });\n        }\n      })), __jsx(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 6\n        }\n      }, videoEditingUrls));\n    }\n  }; // console.log('hi');\n\n\n  return __jsx(\"main\", {\n    className: styles.workflowEditorContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 3\n    }\n  }, __jsx(\"div\", {\n    className: styles.dashboardMenuContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 4\n    }\n  }, __jsx(DashboardMenu, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 5\n    }\n  })), __jsx(\"div\", {\n    className: styles.editor,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 4\n    }\n  }, pageInfo()));\n};\n\nexport async function getServerSideProps({\n  params\n}) {\n  // console.log(params.id);\n  return {\n    props: {\n      id: params.id\n    }\n  };\n}\nexport async function getServerSidePaths({\n  req\n}) {\n  const cookies = parseCookie(req);\n  const res = await fetch('http://127.0.0.1:8000/get-workflow-ids', {\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: cookies.jwt\n    }\n  });\n  const resJson = res.json();\n  const workflowIds = resJson['workflow-ids'];\n  const paths = workflowIds.map(workflowId => {\n    return {\n      params: {\n        id: workflowId.toString()\n      }\n    };\n  });\n  return {\n    paths,\n    fallback: false\n  };\n}\nexport default Workflow;","map":{"version":3,"sources":["C:/Sarthak/YT_Workflow_Cloud/client/pages/workflow/[id].js"],"names":["useSelector","Router","React","useState","useEffect","DashboardMenu","styles","Cookie","parseCookie","WorkflowDescription","AddFile","Workflow","props","jwtToken","state","audioUrls","setAudioUrls","imageUrls","setImageUrls","videoUrls","setVideoUrls","videoEditingUrls","setVideoEditingUrls","description","setDescription","title","setTitle","starred","setStarred","finished","setFinished","fetched","setFetched","id","fetchData","workflowInfoRes","fetch","headers","Authorization","workflowInfoJson","json","workflowInfo","workflowFilesRes","filesJson","fileUrlsJson","pageInfo","images","container","map","imageUrl","dotParts","split","mimeType","length","workflowImage","audios","audioUrl","videos","videoUrl","workflowVideo","workflowEditorContainer","dashboardMenuContainer","editor","getServerSideProps","params","getServerSidePaths","req","cookies","res","jwt","resJson","workflowIds","paths","workflowId","toString","fallback"],"mappings":";;AAAA,SAASA,WAAT,QAA4B,aAA5B,C,CACA;;AACA,OAAOC,MAAP,MAAmB,aAAnB;AACA,OAAOC,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,OAAOC,aAAP,MAA0B,gCAA1B;AACA,OAAOC,MAAP,MAAmB,8CAAnB;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,SAASC,WAAT,QAA4B,8BAA5B;AACA,OAAOC,mBAAP,MAAgC,sCAAhC;AACA,OAAOC,OAAP,MAAoB,0BAApB,C,CAEA;;AAEA,MAAMC,QAAQ,GAAIC,KAAD,IAAW;AAC3B;AACA,QAAMC,QAAQ,GAAGb,WAAW,CAAEc,KAAD,IAAWA,KAAK,CAACD,QAAlB,CAA5B;AAEA,QAAM;AAAA,OAAEE,SAAF;AAAA,OAAaC;AAAb,MAA8Bb,QAAQ,CAAC,EAAD,CAA5C;AACA,QAAM;AAAA,OAAEc,SAAF;AAAA,OAAaC;AAAb,MAA8Bf,QAAQ,CAAC,EAAD,CAA5C;AACA,QAAM;AAAA,OAAEgB,SAAF;AAAA,OAAaC;AAAb,MAA8BjB,QAAQ,CAAC,EAAD,CAA5C;AACA,QAAM;AAAA,OAAEkB,gBAAF;AAAA,OAAoBC;AAApB,MAA4CnB,QAAQ,CAAC,EAAD,CAA1D;AACA,QAAM;AAAA,OAAEoB,WAAF;AAAA,OAAeC;AAAf,MAAkCrB,QAAQ,CAAC,IAAD,CAAhD;AACA,QAAM;AAAA,OAAEsB,KAAF;AAAA,OAASC;AAAT,MAAsBvB,QAAQ,CAAC,IAAD,CAApC;AACA,QAAM;AAAA,OAAEwB,OAAF;AAAA,OAAWC;AAAX,MAA0BzB,QAAQ,CAAC,IAAD,CAAxC;AACA,QAAM;AAAA,OAAE0B,QAAF;AAAA,OAAYC;AAAZ,MAA4B3B,QAAQ,CAAC,IAAD,CAA1C;AACA,QAAM;AAAA,OAAE4B,OAAF;AAAA,OAAWC;AAAX,MAA0B7B,QAAQ,CAAC,KAAD,CAAxC,CAZ2B,CAa3B;;AACA,QAAM8B,EAAE,GAAGrB,KAAK,CAACqB,EAAjB;AAEA7B,EAAAA,SAAS,CAAC,MAAM;AACf,mBAAe8B,SAAf,GAA2B;AAC1B,YAAMC,eAAe,GAAG,MAAMC,KAAK,CAAE,sCAAqCH,EAAG,EAA1C,EAA6C;AAC/EI,QAAAA,OAAO,EAAE;AACR,0BAAgB,kBADR;AAERC,UAAAA,aAAa,EAAG,UAASzB,QAAS;AAF1B;AADsE,OAA7C,CAAnC;AAMA,YAAM0B,gBAAgB,GAAG,MAAMJ,eAAe,CAACK,IAAhB,EAA/B,CAP0B,CAQ1B;;AACA,YAAMC,YAAY,GAAGF,gBAAgB,CAAC,UAAD,CAArC;AACAf,MAAAA,cAAc,CAACiB,YAAY,CAAClB,WAAd,CAAd;AACAG,MAAAA,QAAQ,CAACe,YAAY,CAAChB,KAAd,CAAR;AACAG,MAAAA,UAAU,CAACa,YAAY,CAACd,OAAd,CAAV;AACAG,MAAAA,WAAW,CAACW,YAAY,CAACZ,QAAd,CAAX,CAb0B,CAc1B;AACA;;AAEA,YAAMa,gBAAgB,GAAG,MAAMN,KAAK,CAAE,4CAA2CH,EAAG,EAAhD,EAAmD;AACtFI,QAAAA,OAAO,EAAE;AACR,0BAAgB,kBADR;AAERC,UAAAA,aAAa,EAAG,UAASzB,QAAS;AAF1B;AAD6E,OAAnD,CAApC,CAjB0B,CAuB1B;;AACA,YAAM8B,SAAS,GAAG,MAAMD,gBAAgB,CAACF,IAAjB,EAAxB,CAxB0B,CAyB1B;;AACA,YAAMI,YAAY,GAAGD,SAAS,CAAC,oBAAD,CAA9B,CA1B0B,CA2B1B;;AACA3B,MAAAA,YAAY,CAAC4B,YAAY,CAAC,OAAD,CAAb,CAAZ;AACA1B,MAAAA,YAAY,CAAC0B,YAAY,CAAC,QAAD,CAAb,CAAZ;AACAxB,MAAAA,YAAY,CAACwB,YAAY,CAAC,QAAD,CAAb,CAAZ;AACAtB,MAAAA,mBAAmB,CAACsB,YAAY,CAAC,eAAD,CAAb,CAAnB,CA/B0B,CAgC1B;AACA;;AACAZ,MAAAA,UAAU,CAAC,IAAD,CAAV;AACA;;AACDE,IAAAA,SAAS;AACT,GAtCQ,EAsCN,EAtCM,CAAT;;AAwCA,QAAMW,QAAQ,GAAG,MAAM;AACtB,QAAI,CAACd,OAAL,EAAc;AACb,aAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAP;AACA,KAFD,MAEO;AACN,aACC,MAAC,KAAD,CAAO,QAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAEC,MAAC,mBAAD;AAAqB,QAAA,cAAc,EAAER,WAArC;AAAkD,QAAA,EAAE,EAAEU,EAAtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFD,EAGC;AAAK,QAAA,SAAS,EAAE3B,MAAM,CAACwC,MAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADD,EAEC;AAAK,QAAA,SAAS,EAAExC,MAAM,CAACyC,SAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE9B,SAAS,CAAC+B,GAAV,CAAeC,QAAD,IAAc;AAC5B,cAAMC,QAAQ,GAAGD,QAAQ,CAACE,KAAT,CAAe,GAAf,CAAjB;AACA,cAAMC,QAAQ,GAAGF,QAAQ,CAACA,QAAQ,CAACG,MAAT,GAAkB,CAAnB,CAAzB;AACA,eACC;AAAG,UAAA,IAAI,EAAEJ,QAAT;AAAmB,UAAA,GAAG,EAAEA,QAAxB;AAAkC,UAAA,QAAQ,EAAG,MAAKG,QAAS,EAA3D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACC;AAAK,UAAA,GAAG,EAAEH,QAAV;AAAoB,UAAA,SAAS,EAAE3C,MAAM,CAACgD,aAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADD,CADD;AAKA,OARA,CADF,EAUC,MAAC,OAAD;AAAS,QAAA,QAAQ,EAAE,OAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAVD,CAFD,CAHD,EAkBC;AAAK,QAAA,SAAS,EAAEhD,MAAM,CAACiD,MAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBADD,EAEExC,SAAS,CAACiC,GAAV,CAAeQ,QAAD,IAAc;AAC5B,cAAMN,QAAQ,GAAGM,QAAQ,CAACL,KAAT,CAAe,GAAf,CAAjB;AACA,cAAMC,QAAQ,GAAGF,QAAQ,CAACA,QAAQ,CAACG,MAAT,GAAkB,CAAnB,CAAzB;AACA,eACC;AAAO,UAAA,GAAG,EAAEG,QAAZ;AAAsB,UAAA,QAAQ,MAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACC;AAAQ,UAAA,GAAG,EAAEA,QAAb;AAAuB,UAAA,IAAI,EAAG,SAAQJ,QAAS,EAA/C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADD,MADD;AAKA,OARA,CAFF,CAlBD,EA8BC;AAAK,QAAA,SAAS,EAAE9C,MAAM,CAACmD,MAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADD,EAEEtC,SAAS,CAAC6B,GAAV,CAAeU,QAAD,IAAc;AAC5B,cAAMR,QAAQ,GAAGQ,QAAQ,CAACP,KAAT,CAAe,GAAf,CAAjB;AACA,cAAMC,QAAQ,GAAGF,QAAQ,CAACA,QAAQ,CAACG,MAAT,GAAkB,CAAnB,CAAzB;;AACA,YAAID,QAAQ,KAAK,KAAjB,EAAwB;AACvB,iBACC;AACC,YAAA,GAAG,EAAEM,QADN;AAEC,YAAA,SAAS,EAAEpD,MAAM,CAACqD,aAFnB;AAGC,YAAA,KAAK,EAAC,KAHP;AAIC,YAAA,MAAM,EAAC,KAJR;AAKC,YAAA,QAAQ,MALT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAOC;AAAQ,YAAA,GAAG,EAAED,QAAb;AAAuB,YAAA,IAAI,EAAG,SAAQN,QAAS,EAA/C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAPD,MADD;AAWA,SAZD,MAYO;AACN,iBAAO,MAAC,KAAD,CAAO,QAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAAP;AACA;AACD,OAlBA,CAFF,CA9BD,EAoDC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAM/B,gBAAN,CApDD,CADD;AAwDA;AACD,GA7DD,CAxD2B,CAuH3B;;;AACA,SACC;AAAM,IAAA,SAAS,EAAEf,MAAM,CAACsD,uBAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACC;AAAK,IAAA,SAAS,EAAEtD,MAAM,CAACuD,sBAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACC,MAAC,aAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADD,CADD,EAIC;AAAK,IAAA,SAAS,EAAEvD,MAAM,CAACwD,MAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAgCjB,QAAQ,EAAxC,CAJD,CADD;AAQA,CAhID;;AAkIA,OAAO,eAAekB,kBAAf,CAAkC;AAAEC,EAAAA;AAAF,CAAlC,EAA8C;AACpD;AACA,SAAO;AACNpD,IAAAA,KAAK,EAAE;AACNqB,MAAAA,EAAE,EAAE+B,MAAM,CAAC/B;AADL;AADD,GAAP;AAKA;AAED,OAAO,eAAegC,kBAAf,CAAkC;AAAEC,EAAAA;AAAF,CAAlC,EAA2C;AACjD,QAAMC,OAAO,GAAG3D,WAAW,CAAC0D,GAAD,CAA3B;AACA,QAAME,GAAG,GAAG,MAAMhC,KAAK,CAAC,wCAAD,EAA2C;AACjEC,IAAAA,OAAO,EAAE;AACR,sBAAgB,kBADR;AAERC,MAAAA,aAAa,EAAE6B,OAAO,CAACE;AAFf;AADwD,GAA3C,CAAvB;AAMA,QAAMC,OAAO,GAAGF,GAAG,CAAC5B,IAAJ,EAAhB;AACA,QAAM+B,WAAW,GAAGD,OAAO,CAAC,cAAD,CAA3B;AACA,QAAME,KAAK,GAAGD,WAAW,CAACvB,GAAZ,CAAiByB,UAAD,IAAgB;AAC7C,WAAO;AACNT,MAAAA,MAAM,EAAE;AACP/B,QAAAA,EAAE,EAAEwC,UAAU,CAACC,QAAX;AADG;AADF,KAAP;AAKA,GANa,CAAd;AAOA,SAAO;AACNF,IAAAA,KADM;AAENG,IAAAA,QAAQ,EAAE;AAFJ,GAAP;AAIA;AAED,eAAehE,QAAf","sourcesContent":["import { useSelector } from 'react-redux';\r\n// import { jwt } from '../../components/JWT';\r\nimport Router from 'next/router';\r\nimport React, { useState, useEffect } from 'react';\r\nimport DashboardMenu from '../../components/DashboardMenu';\r\nimport styles from '../../styles/scss/worklow_editor.module.scss';\r\nimport Cookie from 'js-cookie';\r\nimport { parseCookie } from '../../components/parseCookie';\r\nimport WorkflowDescription from '../../components/WorkflowDescription';\r\nimport AddFile from '../../components/addFile';\r\n\r\n// const dispatch = useDispatch();\r\n\r\nconst Workflow = (props) => {\r\n\t// console.log(Router.pathname);\r\n\tconst jwtToken = useSelector((state) => state.jwtToken);\r\n\r\n\tconst [ audioUrls, setAudioUrls ] = useState([]);\r\n\tconst [ imageUrls, setImageUrls ] = useState([]);\r\n\tconst [ videoUrls, setVideoUrls ] = useState([]);\r\n\tconst [ videoEditingUrls, setVideoEditingUrls ] = useState([]);\r\n\tconst [ description, setDescription ] = useState(null);\r\n\tconst [ title, setTitle ] = useState(null);\r\n\tconst [ starred, setStarred ] = useState(null);\r\n\tconst [ finished, setFinished ] = useState(null);\r\n\tconst [ fetched, setFetched ] = useState(false);\r\n\t// const id = Router.query.id;\r\n\tconst id = props.id;\r\n\r\n\tuseEffect(() => {\r\n\t\tasync function fetchData() {\r\n\t\t\tconst workflowInfoRes = await fetch(`http://127.0.0.1:8000/get-workflow/${id}`, {\r\n\t\t\t\theaders: {\r\n\t\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t\t\tAuthorization: `Bearer ${jwtToken}`\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tconst workflowInfoJson = await workflowInfoRes.json();\r\n\t\t\t// .then((workflowInfoJson) => {\r\n\t\t\tconst workflowInfo = workflowInfoJson['workflow'];\r\n\t\t\tsetDescription(workflowInfo.description);\r\n\t\t\tsetTitle(workflowInfo.title);\r\n\t\t\tsetStarred(workflowInfo.starred);\r\n\t\t\tsetFinished(workflowInfo.finished);\r\n\t\t\t// })\r\n\t\t\t// .catch((err) => console.log(err));\r\n\r\n\t\t\tconst workflowFilesRes = await fetch(`http://127.0.0.1:8000/get-workflow-files/${id}`, {\r\n\t\t\t\theaders: {\r\n\t\t\t\t\t'Content-Type': 'application/json',\r\n\t\t\t\t\tAuthorization: `Bearer ${jwtToken}`\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t// .then((res) => res.json())\r\n\t\t\tconst filesJson = await workflowFilesRes.json();\r\n\t\t\t// .then((filesJson) => {\r\n\t\t\tconst fileUrlsJson = filesJson['workflow-file-urls'];\r\n\t\t\t// console.log(filesJson['workflow-file-urls']);\r\n\t\t\tsetAudioUrls(fileUrlsJson['audio']);\r\n\t\t\tsetImageUrls(fileUrlsJson['images']);\r\n\t\t\tsetVideoUrls(fileUrlsJson['videos']);\r\n\t\t\tsetVideoEditingUrls(fileUrlsJson['video_editing']);\r\n\t\t\t// })\r\n\t\t\t// .catch((err) => console.log(err));\r\n\t\t\tsetFetched(true);\r\n\t\t}\r\n\t\tfetchData();\r\n\t}, []);\r\n\r\n\tconst pageInfo = () => {\r\n\t\tif (!fetched) {\r\n\t\t\treturn <div>Fetching</div>;\r\n\t\t} else {\r\n\t\t\treturn (\r\n\t\t\t\t<React.Fragment>\r\n\t\t\t\t\t{/* {console.log(description)} */}\r\n\t\t\t\t\t<WorkflowDescription oldDescription={description} id={id} />\r\n\t\t\t\t\t<div className={styles.images}>\r\n\t\t\t\t\t\t<h2>Images</h2>\r\n\t\t\t\t\t\t<div className={styles.container}>\r\n\t\t\t\t\t\t\t{imageUrls.map((imageUrl) => {\r\n\t\t\t\t\t\t\t\tconst dotParts = imageUrl.split('.');\r\n\t\t\t\t\t\t\t\tconst mimeType = dotParts[dotParts.length - 1];\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<a href={imageUrl} key={imageUrl} download={`hi.${mimeType}`}>\r\n\t\t\t\t\t\t\t\t\t\t<img src={imageUrl} className={styles.workflowImage} />\r\n\t\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t<AddFile fileType={'image'} />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className={styles.audios}>\r\n\t\t\t\t\t\t<h2>Audio</h2>\r\n\t\t\t\t\t\t{audioUrls.map((audioUrl) => {\r\n\t\t\t\t\t\t\tconst dotParts = audioUrl.split('.');\r\n\t\t\t\t\t\t\tconst mimeType = dotParts[dotParts.length - 1];\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t<audio key={audioUrl} controls>\r\n\t\t\t\t\t\t\t\t\t<source src={audioUrl} type={`audio/${mimeType}`} />;\r\n\t\t\t\t\t\t\t\t</audio>\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className={styles.videos}>\r\n\t\t\t\t\t\t<h2>Videos</h2>\r\n\t\t\t\t\t\t{videoUrls.map((videoUrl) => {\r\n\t\t\t\t\t\t\tconst dotParts = videoUrl.split('.');\r\n\t\t\t\t\t\t\tconst mimeType = dotParts[dotParts.length - 1];\r\n\t\t\t\t\t\t\tif (mimeType !== 'mov') {\r\n\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t<video\r\n\t\t\t\t\t\t\t\t\t\tkey={videoUrl}\r\n\t\t\t\t\t\t\t\t\t\tclassName={styles.workflowVideo}\r\n\t\t\t\t\t\t\t\t\t\twidth=\"320\"\r\n\t\t\t\t\t\t\t\t\t\theight=\"240\"\r\n\t\t\t\t\t\t\t\t\t\tcontrols\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<source src={videoUrl} type={`video/${mimeType}`} />;\r\n\t\t\t\t\t\t\t\t\t</video>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\treturn <React.Fragment />;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div>{videoEditingUrls}</div>\r\n\t\t\t\t</React.Fragment>\r\n\t\t\t);\r\n\t\t}\r\n\t};\r\n\r\n\t// console.log('hi');\r\n\treturn (\r\n\t\t<main className={styles.workflowEditorContainer}>\r\n\t\t\t<div className={styles.dashboardMenuContainer}>\r\n\t\t\t\t<DashboardMenu />\r\n\t\t\t</div>\r\n\t\t\t<div className={styles.editor}>{pageInfo()}</div>\r\n\t\t</main>\r\n\t);\r\n};\r\n\r\nexport async function getServerSideProps({ params }) {\r\n\t// console.log(params.id);\r\n\treturn {\r\n\t\tprops: {\r\n\t\t\tid: params.id\r\n\t\t}\r\n\t};\r\n}\r\n\r\nexport async function getServerSidePaths({ req }) {\r\n\tconst cookies = parseCookie(req);\r\n\tconst res = await fetch('http://127.0.0.1:8000/get-workflow-ids', {\r\n\t\theaders: {\r\n\t\t\t'Content-Type': 'application/json',\r\n\t\t\tAuthorization: cookies.jwt\r\n\t\t}\r\n\t});\r\n\tconst resJson = res.json();\r\n\tconst workflowIds = resJson['workflow-ids'];\r\n\tconst paths = workflowIds.map((workflowId) => {\r\n\t\treturn {\r\n\t\t\tparams: {\r\n\t\t\t\tid: workflowId.toString()\r\n\t\t\t}\r\n\t\t};\r\n\t});\r\n\treturn {\r\n\t\tpaths,\r\n\t\tfallback: false\r\n\t};\r\n}\r\n\r\nexport default Workflow;\r\n"]},"metadata":{},"sourceType":"module"}